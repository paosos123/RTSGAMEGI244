this.targetName,this)}function F(){this.bindingObserver.disconnect(),this.source=null,this.context=null}function G(){this.bindingObserver.disconnect(),this.source=null,this.context=null;const e=this.target.$fastView;void 0!==e&&e.isComposed&&(e.unbind(),e.needsBindOnly=!0)}function B(){this.target.removeEventListener(this.targetName,this),this.source=null,this.context=null}function W(e){h.setAttribute(this.target,this.targetName,e)}function U(e){h.setBooleanAttribute(this.target,this.targetName,e)}function $(e){if(null==e&&(e=""),e.create){this.target.textContent="";let t=this.target.$fastView;void 0===t?t=e.create():this.target.$fastTemplate!==e&&(t.isComposed&&(t.remove(),t.unbind()),t=e.create()),t.isComposed?t.needsBindOnly&&(t.needsBindOnly=!1,t.bind(this.source,this.context)):(t.isComposed=!0,t.bind(this.source,this.context),t.insertBefore(this.target),this.target.$fastView=t,this.target.$fastTemplate=e)}else{const t=this.target.$fastView;void 0!==t&&t.isComposed&&(t.isComposed=!1,t.remove(),t.needsBindOnly?t.needsBindOnly=!1:t.unbind()),this.target.textContent=e}}function V(e){this.target[this.targetName]=e}function H(e){const t=this.classVersions||Object.create(null),o=this.target;let i=this.version||0;if(null!=e&&e.length){const n=e.split(/\s+/);for(let e=0,r=n.length;e<r;++e){const r=n[e];""!==r&&(t[r]=i,o.classList.add(r))}}if(this.classVersions=t,this.version=i+1,0!==i){i-=1;for(const e in t)t[e]===i&&o.classList.remove(e)}}class z extends P{constructor(e){super(),this.binding=e,this.bind=k,this.unbind=F,this.updateTarget=W,this.isBindingVolatile=y.isVolatileBinding(this.binding)}get targetName(){return this.originalTargetName}set targetName(e){if(this.originalTargetName=e,void 0!==e)switch(e[0]){case":":if(this.cleanedTargetName=e.substr(1),this.updateTarget=V,"innerHTML"===this.cleanedTargetName){const e=this.binding;this.binding=(t,o)=>h.createHTML(e(t,o))}break;case"?":this.cleanedTargetName=e.substr(1),this.updateTarget=U;break;case"@":this.cleanedTargetName=e.substr(1),this.bind=L,this.unbind=B;break;default:this.cleanedTargetName=e,"class"===e&&(this.updateTarget=H)}}targetAtContent(){this.updateTarget=$,this.unbind=G}createBehavior(e){return new j(e,this.binding,this.isBindingVolatile,this.bind,this.unbind,this.updateTarget,this.cleanedTargetName)}}class j{constructor(e,t,o,i,n,r,a){this.source=null,this.context=null,this.bindingObserver=null,this.target=e,this.binding=t,this.isBindingVolatile=o,this.bind=i,this.unbind=n,this.updateTarget=r,this.targetName=a}handleChange(){this.updateTarget(this.bindingObserver.observe(this.source,this.context))}handleEvent(e){w.setEvent(e);const t=this.binding(this.source,this.context);w.setEvent(null),!0!==t&&e.preventDefault()}}let Y=null;class Z{addFactory(e){e.targetIndex=this.targetIndex,this.behaviorFactories.push(e)}captureContentBinding(e){e.targetAtContent(),this.addFactory(e)}reset(){this.behaviorFactories=[],this.targetIndex=-1}release(){Y=this}static borrow(e){const t=Y||new Z;return t.directives=e,t.reset(),Y=null,t}}function K(e){if(1===e.length)return e[0];let t;const o=e.length,i=e.map((e=>"string"==typeof e?()=>e:(t=e.targetName||t,e.binding))),n=new z(((e,t)=>{let n="";for(let r=0;r<o;++r)n+=i[r](e,t);return n}));return n.targetName=t,n}const q=p.length;function X(e,t){const o=t.split(u);if(1===o.length)return null;const i=[];for(let t=0,n=o.length;t<n;++t){const n=o[t],r=n.indexOf(p);let a;if(-1===r)a=n;else{const t=parseInt(n.substring(0,r));i.push(e.directives[t]),a=n.substring(r+q)}""!==a&&i.push(a)}return i}function Q(e,t,o=!1){const i=t.attributes;for(let n=0,r=i.length;n<r;++n){const a=i[n],s=a.value,l=X(e,s);let c=null;null===l?o&&(c=new z((()=>s)),c.targetName=a.name):c=K(l),null!==c&&(t.removeAttributeN